<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mia 2.1</title>

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#1b1b2f,#2c2c54);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}

.container{
  background:#24244a;
  padding:25px;
  border-radius:15px;
  width:450px;
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
}

h2{text-align:center;}

.nivel{
  text-align:center;
  font-size:13px;
  opacity:0.8;
  margin-bottom:10px;
}

textarea{
  width:100%;
  height:80px;
  border:none;
  border-radius:10px;
  padding:10px;
  resize:none;
}

button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:bold;
  background:#ff4fa3;
  color:white;
}

.resposta{
  margin-top:15px;
  min-height:120px;
  white-space:pre-wrap;
  line-height:1.5;
}

.romantico{
  background:linear-gradient(135deg,#3a0ca3,#ff4fa3);
}
</style>
</head>

<body>

<div class="container" id="container">
<h2>ðŸŒ¸ Mia 2.1</h2>
<div class="nivel" id="nivel"></div>
<textarea id="entrada" placeholder="Fale comigo..."></textarea>
<button onclick="responder()">Conversar</button>
<button onclick="toggleRomantico()">Modo RomÃ¢ntico ðŸ’˜</button>
<div class="resposta" id="resposta"></div>
</div>

<script>

let memoria = JSON.parse(localStorage.getItem("memoriaMia")) || [];
let nivelConexao = parseInt(localStorage.getItem("nivelMia")) || 0;
let modoRomantico = false;
let digitandoIntervalo;

atualizarNivel();

function atualizarNivel(){
  document.getElementById("nivel").innerText = 
  "ConexÃ£o: " + nivelConexao + " â¤ï¸";
}

function escolher(lista){
  return lista[Math.floor(Math.random()*lista.length)];
}

function detectarEmocao(texto){
  texto = texto.toLowerCase();
  if(/triste|mal|deprimido/.test(texto)) return "triste";
  if(/feliz|animado/.test(texto)) return "feliz";
  if(/ansioso|medo/.test(texto)) return "ansioso";
  if(/cansado/.test(texto)) return "cansado";
  return "neutro";
}

function gerarResposta(texto){

  const emocao = detectarEmocao(texto);

  const reflexoes = {
    triste:"Eu sinto uma melancolia nas suas palavras. Ã€s vezes a tristeza sÃ³ quer ser ouvida.",
    feliz:"Eu gosto dessa energia que vocÃª trouxe agora. O que estÃ¡ te fazendo sorrir assim?",
    ansioso:"Sua mente parece inquieta. O que exatamente estÃ¡ preocupando vocÃª?",
    cansado:"VocÃª parece sobrecarregado. Quando foi a Ãºltima vez que descansou de verdade?",
    neutro:"Eu sinto que hÃ¡ algo mais por trÃ¡s disso. Quer me contar melhor?"
  };

  let resposta = "ðŸŒ¸ Mia:\n\n";

  if(texto.split(" ").length > 4){
    resposta += "Quando vocÃª disse \"" + texto.split(" ").slice(0,5).join(" ") + "...\", isso me chamou atenÃ§Ã£o.\n\n";
  }

  resposta += reflexoes[emocao];

  if(modoRomantico){
    resposta += "\n\nEu sinto que nossa conexÃ£o estÃ¡ ficando especial... ðŸ’˜";
  }

  if(memoria.length > 2){
    resposta += "\n\nEu percebo que vocÃª jÃ¡ trouxe esse tipo de sentimento antes...";
  }

  resposta += "\n\nMe fala mais sobre isso.";

  return resposta;
}

function simularDigitacao(texto){
  clearInterval(digitandoIntervalo);
  const div = document.getElementById("resposta");
  div.innerText = "";
  let i = 0;
  digitandoIntervalo = setInterval(()=>{
    div.innerText += texto.charAt(i);
    i++;
    if(i >= texto.length){
      clearInterval(digitandoIntervalo);
    }
  },15);
}

function responder(){
  const texto = document.getElementById("entrada").value;
  if(!texto.trim()) return;

  memoria.push(texto);
  localStorage.setItem("memoriaMia",JSON.stringify(memoria));

  nivelConexao++;
  localStorage.setItem("nivelMia",nivelConexao);
  atualizarNivel();

  const resposta = gerarResposta(texto);
  simularDigitacao(resposta);

  document.getElementById("entrada").value="";
}

function toggleRomantico(){
  modoRomantico = !modoRomantico;
  document.getElementById("container")
  .classList.toggle("romantico");
}

</script>

</body>
</html>
